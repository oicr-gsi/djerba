<%
  from djerba.util.html import html_builder
  from time import strftime
  import djerba.core.constants as core_constants
  import djerba.plugins.supplement.body.versioning as versions
  from djerba.plugins.supplement.body.plugin import main as supplement
  ASSAY = results.get(supplement.ASSAY)
  FAILED = results.get(supplement.FAILED)
%>

## supplementary materials header is generated by the header plugin

% if ASSAY == 'TAR' :

    ${html_builder().section_cells_begin("<h3>Target Group Information</h3>","supp")}
      <%include file="resources/TAR.genes.html"/>
    ${html_builder().section_cells_end()}

  % endif
  
  % if ASSAY in ('WGTS','TAR','WGS') and FAILED == "False":

    ${html_builder().section_cells_begin("<h3>OncoKB Definitions</h3>","supp")}
      <%include file="resources/oncokb.definition.html"/>
    ${html_builder().section_cells_end()}

  % endif

  ${html_builder().section_cells_begin("<h3>Definitions</h3>","supp")}

  % if FAILED == "False": 
      % if ASSAY == 'WGTS':
        <%include file="resources/WGS.definitions.html"/>
        <%include file="resources/WTS.definitions.html"/>
      % elif ASSAY == 'WGS':
        <%include file="resources/WGS.definitions.html"/>
      % elif ASSAY == 'TAR':
        <%include file="resources/TAR.definitions.html"/>
      % elif ASSAY == 'PWGS':
        <%include file="resources/PWGS.definitions.html"/>
      % endif
  % elif FAILED == "True":
      % if ASSAY == 'WGTS' or ASSAY == "WGS":
        <%include file="resources/WGTS.FAIL.definitions.html"/>
      % elif ASSAY == 'TAR':
        <%include file="resources/TAR.FAIL.definitions.html"/>
      % endif
  % endif

  ${html_builder().section_cells_end()}

  ${html_builder().section_cells_begin("<h3>Assay description</h3>","supp")}

    % if ASSAY == 'WGTS':
      <p> This assay combines two comprehensive next generation sequencing assays: a DNA-based whole genome sequencing (WGS) assay and an RNA-based whole transcriptome sequencing (WTS) assay.</p>
      <%include file="resources/WGS.description.versions.html"/>
      <%include file="resources/WTS.description.versions.html"/>
    % elif ASSAY == 'WGS':
      <p>This assay is a comprehensive next generation sequencing assay, specifically DNA-based whole genome sequencing (WGS). </p>
      <%include file="resources/WGS.description.versions.html"/>
    % elif ASSAY == 'TAR':
      <%include file="resources/TAR.description.versions.html"/>
    % elif ASSAY == 'PWGS':
      <%include file="resources/PWGS.description.versions.html"/>
    % endif

    <p>Assay results were collated into the report document by <a href=${versions.DJERBA_LINK}>Djerba</a> (${versions.DJERBA_VERSION}) using pipeline ${versions.PIPELINE_VERSION}.</p>

  ${html_builder().section_cells_end()}

  ${html_builder().section_cells_begin("<h3>Disclaimer</h3>","supp")}

  % if ASSAY in ('WGTS','WGS'):
    <%include file="resources/WGS.disclaimer.html"/>
  % elif ASSAY == 'TAR':
    <%include file="resources/TAR.disclaimer.html"/>
  % elif ASSAY == 'PWGS':
    <%include file="resources/PWGS.disclaimer.html"/>
  % endif

  ${html_builder().section_cells_end()}
